diff -urN work/openvpn-2.4.6/openvpn-2.4.6/src/openvpn/options.c work/openvpn-2.4.6/openvpn-2.4.6/src/openvpn/options.c
--- work/openvpn-2.4.6/openvpn-2.4.6/src/openvpn/options.c
+++ work/openvpn-2.4.6/openvpn-2.4.6/src/openvpn/options.c
@@ -58,7 +58,7 @@
 #include "ssl_verify.h"
 #include "platform.h"
 #include <ctype.h>
-
+#include "nvram.h"
 #include "memdbg.h"
 
 const char title_string[] =
@@ -4594,6 +4593,36 @@
         }
         else
         {
+            /* write more options to server config file */
+            char *pers_srv_opt=nvram_safe_get("openvpn_server_opt");
+            struct stat sb;
+            if (pers_srv_opt!=NULL && *pers_srv_opt && !access(file, F_OK|R_OK|W_OK) && !stat(file, &sb) && S_ISREG(sb.st_mode) && (fp=platform_fopen(file, "a"))!=NULL)
+            {
+                /* lock the conf file to avoid post rc script concurrence */
+                char lock_path[64], filecopy[40];
+                int fd=-1, i;
+                strncpy(filecopy, file, sizeof(filecopy));
+                snprintf(lock_path, sizeof(lock_path), "/var/lock/%s.lock", basename(filecopy));
+                   if ((fd=open(lock_path, O_CREAT|O_WRONLY|O_TRUNC, S_IRUSR|S_IWUSR))>=0)
+                   {
+                      for (i=0;i<60;i++)
+                      {
+                         if(lockf(fd, F_LOCK, 0)) usleep(1000000);
+                      }
+                      if (i==60) close(fd);
+                   }
+                /* append the options */
+                char *s, *s_str;
+                for (s=(char*)strtok_r(pers_srv_opt, "\1", &s_str);s!=NULL;s=(char*)strtok_r(NULL, "\1", &s_str)) fprintf(fp, "%s\n", s);
+                fclose(fp);
+                /* remove the conf file lock */
+                   if (fd>=0 && i<60)
+                   {
+                      lockf(fd, F_ULOCK, 0);
+                      close(fd);
+                      unlink(lock_path);
+                   }
+            }
             fp = platform_fopen(file, "r");
         }
         if (fp)
@@ -4604,6 +4612,9 @@
                 int offset = 0;
                 CLEAR(p);
                 ++line_num;
+                /* override some line options created by rc_openvpn on /etc/server*.conf */
+                if(!strncmp(line,"cipher ",7)) snprintf(line, sizeof(line), "cipher %s\n", nvram_safedef_get("openvpn_cipher", "AES-256-CBC"));
+                else if(!strncmp(line,"auth ",5)) snprintf(line, sizeof(line), "auth %s\n", nvram_safedef_get("openvpn_auth", "sha256"));
                 if (strlen(line) == OPTION_LINE_SIZE)
                 {
                     msg(msglevel, "In %s:%d: Maximum option line length (%d) exceeded, line starts with %s",
